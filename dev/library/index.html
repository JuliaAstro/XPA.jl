<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · XPA.jl Package</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="XPA.jl Package logo"/></a><h1>XPA.jl Package</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">The XPA.jl package</a></li><li><a class="toctext" href="../install/">Installation</a></li><li><a class="toctext" href="../intro/">Using the XPA messaging system</a></li><li><a class="toctext" href="../client/">Client operations</a></li><li><a class="toctext" href="../server/">Implementing a server</a></li><li><a class="toctext" href="../misc/">Utilities</a></li><li class="current"><a class="toctext" href>Reference</a><ul class="internal"><li><a class="toctext" href="#XPA-client-methods-and-types-1">XPA client methods and types</a></li><li><a class="toctext" href="#XPA-server-methods-and-types-1">XPA server methods and types</a></li><li><a class="toctext" href="#Utilities-1">Utilities</a></li><li><a class="toctext" href="#Constants-1">Constants</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Reference</a></li></ul><a class="edit-page" href="https://github.com/emmt/XPA.jl/blob/master/docs/src/library.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Reference</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Reference-1" href="#Reference-1">Reference</a></h1><p>The following provides detailled documentation about types and methods provided by the XPA package.  This information is also available from the REPL by typing <code>?</code> followed by the name of a method or a type.</p><h2><a class="nav-anchor" id="XPA-client-methods-and-types-1" href="#XPA-client-methods-and-types-1">XPA client methods and types</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.Client" href="#XPA.Client"><code>XPA.Client</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>An instance of the mutable structure <code>XPA.Client</code> represents a client connection in the XPA Messaging System.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/types.jl#L44-L49">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.get" href="#XPA.get"><code>XPA.get</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">XPA.get([T, [dims,]] [xpa,] apt, args...)</code></pre><p>retrieves data from one or more XPA access points identified by <code>apt</code> (a template name, a <code>host:port</code> string or the name of a Unix socket file) with arguments <code>args...</code> (automatically converted into a single string where the arguments are separated by a single space).  Optional argument <code>xpa</code> specifies an XPA handle (created by <a href="#XPA.Client"><code>XPA.Client</code></a>) for faster connections.  The returned value depends on the optional arguments <code>T</code> and <code>dims</code>.</p><p>If neither <code>T</code> nor <code>dims</code> are specified, an instance of <a href="#XPA.Reply"><code>XPA.Reply</code></a> is returned with all the answer(s) from the XPA server(s).  The following keywords are available:</p><ul><li><p>Keyword <code>nmax</code> specifies the maximum number of answers, <code>nmax=1</code> by default. Specify <code>nmax=-1</code> to use the maximum number of XPA hosts.</p></li><li><p>Keyword <code>throwerrors</code> specifies whether to check for errors.  If this keyword is set true, an exception is thrown for the first error message encountered in the list of answers.  By default, <code>throwerrors</code> is false.</p></li><li><p>Keyword <code>mode</code> specifies options in the form <code>&quot;key1=value1,key2=value2&quot;</code>.</p></li></ul><p>If <code>T</code> and, possibly, <code>dims</code> are specified, a single answer and no errors are expected (as if <code>nmax=1</code> and <code>throwerrors=true</code>) and the data part of the answer is converted according to <code>T</code> which must be a type and <code>dims</code> which is an optional list of dimensions:</p><ul><li><p>If only <code>T</code> is specified, it can be <code>String</code> to return a string interpreting the data as ASCII characters or a type like <code>Vector{S}</code> to return the largest vector of elements of type <code>S</code> that can be extracted from the returned data.</p></li><li><p>If both <code>T</code> and <code>dims</code> are specified, <code>T</code> can be a type like <code>Array{S}</code> or <code>Array{S,N}</code> and <code>dims</code> a list of <code>N</code> dimensions to retrieve the data as an array of type <code>Array{S,N}</code>.</p></li></ul><p>See also <a href="#XPA.Client"><code>XPA.Client</code></a>, <a href="#XPA.get_data"><code>XPA.get_data</code></a>, <a href="#XPA.set"><code>XPA.set</code></a> and <a href="#XPA.verify"><code>XPA.verify</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/client.jl#L162-L203">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.Reply" href="#XPA.Reply"><code>XPA.Reply</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p><code>XPA.Reply</code> is used to store the answer(s) of <a href="#XPA.get"><code>XPA.get</code></a> and <a href="#XPA.set"><code>XPA.set</code></a> requests.  Method <code>length</code> applied to an object of type <code>Reply</code> yields the number of replies.  Methods <a href="#XPA.get_data"><code>XPA.get_data</code></a>, <a href="#XPA.get_server"><code>XPA.get_server</code></a> and <a href="#XPA.get_message"><code>XPA.get_message</code></a> can be used to retrieve the contents of an object of type <code>XPA.Reply</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/types.jl#L62-L70">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.get_data" href="#XPA.get_data"><code>XPA.get_data</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">get_data([T, [dims,]] rep, i=1; preserve=false)</code></pre><p>yields the data associated with the <code>i</code>-th reply in XPA answer <code>rep</code>.  The returned value depends on the optional leading arguments <code>T</code> and <code>dims</code>:</p><ul><li><p>If neither <code>T</code> nor <code>dims</code> are specified, a vector of bytes (<code>UInt8</code>) is returned.</p></li><li><p>If only <code>T</code> is specified, it can be <code>String</code> to return a string interpreting the data as ASCII characters or a type like <code>Vector{S}</code> to return the largest vector of elements of type <code>S</code> that can be extracted from the data.</p></li><li><p>If both <code>T</code> and <code>dims</code> are specified, <code>T</code> can be an array type like <code>Array{S}</code> or <code>Array{S,N}</code> and <code>dims</code> a list of <code>N</code> dimensions to retrieve the data as an array of type <code>Array{S,N}</code>.</p></li></ul><p>Keyword <code>preserve</code> can be used to specifiy whether or not to preserve the internal data buffer in <code>rep</code> for another call to <code>XPA.get_data</code>.  By default, <code>preserve=true</code> when <code>T = String</code> is specified and <code>preserve=false</code> otherwise.</p><p>In any cases, the type of the result is predictible, so there should be no type instability issue.</p><p>See also <a href="#XPA.get"><code>XPA.get</code></a>, <a href="#XPA.get_message"><code>XPA.get_message</code></a>, <a href="#XPA.get_server"><code>XPA.get_server</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/client.jl#L466-L495">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.get_server" href="#XPA.get_server"><code>XPA.get_server</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">get_server(rep, i=1)</code></pre><p>yields the XPA identifier of the server which sent the <code>i</code>-th reply in XPA answer <code>rep</code>.  An empty string is returned if there is no <code>i</code>-th reply.</p><p>See also <a href="#XPA.get"><code>XPA.get</code></a>, <a href="#XPA.get_message"><code>XPA.get_message</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/client.jl#L338-L348">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.get_message" href="#XPA.get_message"><code>XPA.get_message</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">get_message(rep, i=1)</code></pre><p>yields the message associated with the <code>i</code>-th reply in XPA answer <code>rep</code>.  An empty string is returned if there is no <code>i</code>-th reply.</p><p>See also <a href="#XPA.get"><code>XPA.get</code></a>, <a href="#XPA.has_message"><code>XPA.has_message</code></a>, <a href="#XPA.has_error"><code>XPA.has_error</code></a>, <a href="#XPA.get_server"><code>XPA.get_server</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/client.jl#L351-L362">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.has_error" href="#XPA.has_error"><code>XPA.has_error</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">XPA.has_error(rep, i=1) -&gt; boolean</code></pre><p>yields whether <code>i</code>-th XPA answer <code>rep</code> contains an error message.  The error message can be retrieved by calling <code>XPA.get_message(rep, i)</code>.</p><p>See also <a href="#XPA.get"><code>XPA.get</code></a>, <a href="#XPA.has_message"><code>XPA.has_message</code></a>, <a href="#XPA.get_message"><code>XPA.get_message</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/client.jl#L365-L376">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.has_errors" href="#XPA.has_errors"><code>XPA.has_errors</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">XPA.has_errors(rep) -&gt; boolean</code></pre><p>yields whether answer <code>rep</code> contains any error messages.</p><p>See also <a href="#XPA.get"><code>XPA.get</code></a>, <a href="#XPA.has_error"><code>XPA.has_error</code></a>, <a href="#XPA.get_message"><code>XPA.get_message</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/client.jl#L383-L392">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.has_message" href="#XPA.has_message"><code>XPA.has_message</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">XPA.has_message(rep, i=1) -&gt; boolean</code></pre><p>yields whether <code>i</code>-th XPA answer <code>rep</code> contains an error message.</p><p>See also <a href="#XPA.get"><code>XPA.get</code></a>, <a href="#XPA.has_message"><code>XPA.has_message</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/client.jl#L402-L411">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.verify" href="#XPA.verify"><code>XPA.verify</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">verify(rep [, i]; throwerrors::Bool=false) -&gt; boolean</code></pre><p>verifies whether answer(s) in the result <code>rep</code> from an <a href="#XPA.get"><code>XPA.get</code></a> or <a href="#XPA.set"><code>XPA.set</code></a> request has no errors.  If index <code>i</code> is specified only that specific answer is considered; otherwise, all answers are verified.  If keyword <code>throwerrors</code> is true, an exception is thrown for the first error found if any.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/client.jl#L430-L441">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.set" href="#XPA.set"><code>XPA.set</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">XPA.set([xpa,] apt, args...; data=nothing) -&gt; rep</code></pre><p>sends <code>data</code> to one or more XPA access points identified by <code>apt</code> with arguments <code>args...</code> (automatically converted into a single string where the arguments are separated by a single space).  The result is an instance of <a href="#XPA.Reply"><code>XPA.Reply</code></a>.  Optional argument <code>xpa</code> specifies an XPA handle (created by <a href="#XPA.Client"><code>XPA.Client</code></a>) for faster connections.</p><p>The following keywords are available:</p><ul><li><p><code>data</code> specifies the data to send, may be <code>nothing</code>, an array or a string. If it is an array, it must have contiguous elements (as a for a <em>dense</em> array) and must implement the <code>pointer</code> method.</p></li><li><p><code>nmax</code> specifies the maximum number of recipients, <code>nmax=1</code> by default. Specify <code>nmax=-1</code> to use the maximum possible number of XPA hosts.</p></li><li><p><code>mode</code> specifies options in the form <code>&quot;key1=value1,key2=value2&quot;</code>.</p></li><li><p><code>throwerrors</code> specifies whether to check for errors.  If this keyword is set <code>true</code>, an exception is thrown for the first error message encountered in the list of answers.  By default, <code>throwerrors</code> is false.</p></li></ul><p>See also <a href="#XPA.Client"><code>XPA.Client</code></a>, <a href="#XPA.get"><code>XPA.get</code></a> and <a href="#XPA.verify"><code>XPA.verify</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/client.jl#L600-L628">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.buffer" href="#XPA.buffer"><code>XPA.buffer</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">buf = buffer(data)</code></pre><p>yields an object <code>buf</code> representing the contents of <code>data</code> and which can be used as an argument to <code>ccall</code> without the risk of having the data garbage collected.  Argument <code>data</code> can be <code>nothing</code>, a dense array or a string.  If <code>data</code> is an array <code>buf</code> is just an alias for <code>data</code>.  If <code>data</code> is a string, <code>buf</code> is a temporary byte buffer where the string has been copied.</p><p>Standard methods <code>pointer</code> and <code>sizeof</code> can be applied to <code>buf</code> to retieve the address and the size (in bytes) of the data and <code>convert(Ptr{Cvoid},buf)</code> can also be used.</p><p>See also <a href="#XPA.set"><code>XPA.set</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/client.jl#L668-L685">source</a></section><h2><a class="nav-anchor" id="XPA-server-methods-and-types-1" href="#XPA-server-methods-and-types-1">XPA server methods and types</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.Server" href="#XPA.Server"><code>XPA.Server</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>An instance of the mutable structure <code>XPA.Server</code> represents a server connection in the XPA Messaging System.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/types.jl#L79-L84">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.SendCallback" href="#XPA.SendCallback"><code>XPA.SendCallback</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>An instance of the <code>XPA.SendCallback</code> structure represents a callback called to serve an <a href="#XPA.get"><code>XPA.get</code></a> request.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/types.jl#L91-L96">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.store!" href="#XPA.store!"><code>XPA.store!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">XPA.store!(buf, data)</code></pre><p>or</p><pre><code class="language-julia">XPA.store!(buf, ptr, len)</code></pre><p>store into the send buffer <code>buf</code> a dynamically allocated copy of the contents of <code>data</code> or of the <code>len</code> bytes at address <code>ptr</code>.</p><div class="admonition warning"><div class="admonition-title">Warning</div><div class="admonition-text"><p>This method is meant to be used in a <em>send</em> callback to store the result of an <a href="#XPA.get"><code>XPA.get</code></a> request processed by an XPA server.  Memory leaks are expected if used in another context.</p></div></div><p>See also <a href="#XPA.Server"><code>XPA.Server</code></a>, <a href="#XPA.SendCallback"><code>XPA.SendCallback</code></a> and <a href="#XPA.get"><code>XPA.get</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/server.jl#L322-L344">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.ReceiveCallback" href="#XPA.ReceiveCallback"><code>XPA.ReceiveCallback</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>An instance of the <code>XPA.ReceiveCallback</code> structure represents a callback called to serve an <a href="#XPA.set"><code>XPA.set</code></a> request.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/types.jl#L120-L125">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.peek" href="#XPA.peek"><code>XPA.peek</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">XPA.peek(T, buf, i=1) -&gt; val</code></pre><p>yields the <code>i</code>-th binary value of type <code>T</code> stored into receive buffer <code>buf</code>. Bounds checking is performed unless <code>@inbounds</code> is active.</p><p>Another usage of the <code>XPA.peek</code> method is to <em>convert</em> the contents of the receive buffer into an array:</p><pre><code class="language-julia">XPA.peek(Vector{T}, [len,] buf) -&gt; vec
XPA.peek(Array{T[,N]}, (dim1, ..., dimN), buf) -&gt; arr</code></pre><p>yield a Julia vector <code>vec</code> or array <code>arr</code> whose elements are of type <code>T</code> and dimensions are <code>len</code> or <code>(dim1, ..., dimN)</code>.  For a vector, if the length is unspecified, the vector of maximal length that fits in the buffer is returned.</p><p>If keyword <code>temporary</code> is true, then <code>unsafe_wrap</code> is called (with option <code>own=false</code>) to wrap the buffer contents into a Julia array whose life-time cannot exceeds that of the callback.  Otherwise, a copy of the buffer contents is returned.</p><p>See also <a href="#XPA.ReceiveCallback"><code>XPA.ReceiveCallback</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/server.jl#L411-L438">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.error-Tuple{XPA.Server,AbstractString}" href="#Base.error-Tuple{XPA.Server,AbstractString}"><code>Base.error</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">error(srv, msg) -&gt; XPA.FAILURE</code></pre><p>communicates error message <code>msg</code> to the client when serving a request by XPA server <code>srv</code>.  This method shall only be used by the send/receive callbacks of an XPA server.</p><p>Also see: <a href="#XPA.Server"><code>XPA.Server</code></a>, <a href="#XPA.message"><code>XPA.message</code></a>,           <a href="#XPA.SendCallback"><code>XPA.SendCallback</code></a>, <a href="#XPA.ReceiveCallback"><code>XPA.ReceiveCallback</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/server.jl#L286-L298">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.poll" href="#XPA.poll"><code>XPA.poll</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">XPA.poll(sec, maxreq)</code></pre><p>polls for XPA events.  This method is meant to implement a polling event loop which checks for and processes XPA requests without blocking.</p><p>Argument <code>sec</code> specifies a timeout in seconds (rounded to millisecond precision).  If <code>sec</code> is positive, the method blocks no longer than this amount of time.  If <code>sec</code> is strictly negative, the routine blocks until the occurence of an event to be processed.</p><p>Argument <code>maxreq</code> specifies how many requests will be processed.  If <code>maxreq &lt; 0</code>, then no events are processed, but instead, the returned value indicates the number of events that are pending.  If <code>maxreq == 0</code>, then all currently pending requests will be processed.  Otherwise, up to <code>maxreq</code> requests will be processed.  The most usual values for <code>maxreq</code> are <code>0</code> to process all requests and <code>1</code> to process one request.</p><p>The following example implements a polling loop which has no noticeable impact on the consumption of CPU when no requests are emitted to the server:</p><pre><code class="language-julia">const __running = Ref{Bool}(false)

function run()
    global __running
    __running[] = true
    while __running[]
        XPA.poll(-1, 1)
    end
end</code></pre><p>Here the global variable <code>__running</code> is a reference to a boolean whose value indicates whether to continue to run the XPA server(s) created by the process. The idea is to pass the reference to the callbacks of the server (as their client data for instance) and let the callbacks stop the loop by setting the contents of the reference to <code>false</code>.</p><p>Another possibility is to use <a href="#XPA.mainloop"><code>XPA.mainloop</code></a> (which to see).</p><p>To let Julia performs other tasks, the polling method may be repeatedly called by a Julia timer.  The following example does this.  Calling <code>resume</code> starts polling for XPA events immediately and then every 100ms.  Calling <code>suspend</code> suspends the processing of XPA events.</p><pre><code class="language-julia">const __timer = Ref{Timer}()

ispolling() = (isdefined(__timer, 1) &amp;&amp; isopen(__timer[]))

resume() =
    if ! ispolling()
        __timer[] = Timer((tm) -&gt; XPA.poll(0, 0), 0.0, interval=0.1)
    end

suspend() =
    ispolling() &amp;&amp; close(__timer[])</code></pre><p>Also see: <a href="#XPA.Server"><code>XPA.Server</code></a>, <a href="#XPA.mainloop"><code>XPA.mainloop</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/server.jl#L515-L580">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.message" href="#XPA.message"><code>XPA.message</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">XPA.message(srv, msg)</code></pre><p>sets a specific acknowledgment message back to the client. Argument <code>srv</code> is the XPA server serving the client and <code>msg</code> is the acknowledgment message. This method shall only be used by the receive callback of an XPA server.</p><p>Also see: <a href="#XPA.Server"><code>XPA.Server</code></a>, <a href="#Base.error-Tuple{XPA.Server,AbstractString}"><code>XPA.error</code></a>,           <a href="#XPA.ReceiveCallback"><code>XPA.ReceiveCallback</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/server.jl#L306-L318">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.mainloop" href="#XPA.mainloop"><code>XPA.mainloop</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">XPA.mainloop()</code></pre><p>runs XPA event loop which handles the requests sent to the server(s) created by this process.  The loop runs until all servers created by this process have been closed.</p><p>In the following example, the receive callback function close the server when it receives a <code>&quot;quit&quot;</code> command:</p><pre><code class="language-julia">function rproc(::Nothing, srv::XPA.Server, params::String,
               buf::Ptr{UInt8}, len::Integer)
    status = XPA.SUCCESS
    if params == &quot;quit&quot;
        close(srv)
    elseif params == ...
        ...
    end
    return status
end</code></pre><p>Also see: <a href="#XPA.Server"><code>XPA.Server</code></a>, <a href="#XPA.mainloop"><code>XPA.mainloop</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/server.jl#L585-L612">source</a></section><h2><a class="nav-anchor" id="Utilities-1" href="#Utilities-1">Utilities</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.list" href="#XPA.list"><code>XPA.list</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">XPA.list(xpa=XPA.TEMPORARY)</code></pre><p>yields a list of available XPA access points.  Optional argument <code>xpa</code> is a persistent XPA client connection; if omitted, a temporary client connection will be created.  The result is a vector of <a href="#XPA.AccessPoint"><code>XPA.AccessPoint</code></a> instances.</p><p>See also <a href="#XPA.Client"><code>XPA.Client</code></a> and <a href="#XPA.find"><code>XPA.find</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/client.jl#L53-L65">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.AccessPoint" href="#XPA.AccessPoint"><code>XPA.AccessPoint</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>An instance of the <code>XPA.AccessPoint</code> structure represents an available XPA server.  A vector of such instances is returned by the <a href="#XPA.list"><code>XPA.list</code></a> utility.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/types.jl#L156-L162">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.find" href="#XPA.find"><code>XPA.find</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">XPA.find([xpa=XPA.TEMPORARY,] ident)</code></pre><p>yields the address of the first XPA server matching <code>ident</code> or <code>nothing</code> if none is found.  If more than one match occurs, the first match is returned.</p><p>Argument <code>ident</code> may be a regular expression or a string of the form <code>CLASS:NAME</code> where <code>CLASS</code> and <code>CLASS</code> are matched against the server class and name respectively (they may be <code>&quot;*&quot;</code> to match any).</p><p>Keyword <code>user</code> may be used to specify another name than <code>ENV[&quot;user&quot;]</code> for the owner of the server process.  Set <code>user=nothing</code> or <code>user=&quot;*&quot;</code> to match any users.</p><p>Keyword <code>throwerrors</code> may be set true (it is false by default) to automatically throw an exception if no match is found (instead of returning <code>nothing</code>).</p><p>See also <a href="#XPA.Client"><code>XPA.Client</code></a> and <a href="#XPA.list"><code>XPA.list</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/client.jl#L93-L114">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.getconfig" href="#XPA.getconfig"><code>XPA.getconfig</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">XPA.getconfig(key) -&gt; val</code></pre><p>yields the value associated with configuration parameter <code>key</code> (a string or a symbol).  The following parameters are available (see XPA doc. for more information):</p><table><tr><th>Key Name</th><th>Default Value</th></tr><tr><td><code>&quot;XPA_MAXHOSTS&quot;</code></td><td><code>100</code></td></tr><tr><td><code>&quot;XPA_SHORT_TIMEOUT&quot;</code></td><td><code>15</code></td></tr><tr><td><code>&quot;XPA_LONG_TIMEOUT&quot;</code></td><td><code>180</code></td></tr><tr><td><code>&quot;XPA_CONNECT_TIMEOUT&quot;</code></td><td><code>10</code></td></tr><tr><td><code>&quot;XPA_TMPDIR&quot;</code></td><td><code>&quot;/tmp/.xpa&quot;</code></td></tr><tr><td><code>&quot;XPA_VERBOSITY&quot;</code></td><td><code>true</code></td></tr><tr><td><code>&quot;XPA_IOCALLSXPA&quot;</code></td><td><code>false</code></td></tr></table><p>Also see <a href="#XPA.setconfig!"><code>XPA.setconfig!</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/misc.jl#L25-L46">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.setconfig!" href="#XPA.setconfig!"><code>XPA.setconfig!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">XPA.setconfig!(key, val) -&gt; oldval</code></pre><p>set the value associated with configuration parameter <code>key</code> to be <code>val</code>.  The previous value is returned.</p><p>Also see <a href="#XPA.getconfig"><code>XPA.getconfig</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/misc.jl#L61-L71">source</a></section><h2><a class="nav-anchor" id="Constants-1" href="#Constants-1">Constants</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.SUCCESS" href="#XPA.SUCCESS"><code>XPA.SUCCESS</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><p><code>XPA.SUCCESS</code> and <code>XPA.FAILURE</code> are the possible values returned by the callbacks of an XPA server.</p></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/types.jl#L15-L20">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="XPA.FAILURE" href="#XPA.FAILURE"><code>XPA.FAILURE</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><div><p><code>XPA.SUCCESS</code> and <code>XPA.FAILURE</code> are the possible values returned by the callbacks of an XPA server.</p></div></div></div><a class="source-link" target="_blank" href="https://github.com/emmt/XPA.jl/blob/6c316d2ac69c10a1726a5b2ef599dbdf0dc21298/src/types.jl#L23">source</a></section><footer><hr/><a class="previous" href="../misc/"><span class="direction">Previous</span><span class="title">Utilities</span></a></footer></article></body></html>
